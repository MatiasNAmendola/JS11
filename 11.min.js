if(typeof window==="undefined"&&typeof global==="undefined")var console={log:function(h){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?h="message"in arguments[0]?arguments[0].message:"":typeof h==="undefined"&&(h="");postMessage({type:"console",message:h})}};var JS11={};JS11.compiler=new Function;
(function(h){h.toJS=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="text"in arguments[0]?arguments[0].text:"":typeof a==="undefined"&&(a="");this.text=a;this.resetPlaceholderArrays();this.strikeImmutableElements();this.convertEnglishOperators();this.normaliseFormatting();this.detectNonEmptyObjectLiterals();this.preserveEmptyObjectLiterals();this.wrapLoopsAndConditionals();this.insertVar();this.shorthandLoops();this.convertMessagingSyntax();this.reconstituteFunctions();
this.reconstituteObjectLiterals();this.convertNamedArguments();this.rewriteWith();this.separateAdjacentTerminators();this.restoreImmutables();this.finalise();this.resetPlaceholderArrays();a=this.text;this.text="";return a};h.text="";h.placeholders={};h.resetPlaceholderArrays=function(){this.placeholders.blockcomments=[];this.placeholders.linecomments=[];this.placeholders.strings=[];this.placeholders.regex=[]};h.enumerateRegex=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===
null?a="text"in arguments[0]?arguments[0].text:"":typeof a==="undefined"&&(a="");var d="",e="";a.charAt(0)!=="/"&&(d=a.substr(0,a.indexOf("/")),a=a.substring(a.indexOf("/"),a.length));a.charAt(a.length-1).match(/[\/gimy]/)===null&&(e=a.charAt(a.length-1),a=a.substring(0,a.length-1));this.placeholders.regex.push(a);return d+"@PLACEHOLDERREGEX"+(this.placeholders.regex.length-1)+"END"+e};h.enumerateString=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="text"in
arguments[0]?arguments[0].text:"":typeof a==="undefined"&&(a="");if(a.match(/\n/)!==null){var d=a.split("\n"),e=Infinity,b,f=!0;if(d[0].match(/^ +/)===null)for(var c=1;c<d.length;c++){var l=d[c].replace(/^( +|\t+)[^\1][\s\S]*$/,"$1");if(l!==d[c]){if(l.charAt(0)!==b&&c>1){f=!1;break}e=Math.min(l.length,e);b=l.charAt(0)}else e=0}console.log(e);if(e>0&&e<Infinity&&f===!0){for(c=1;c<d.length;c++)d[c]=d[c].substring(e,d[c].length);a=d.join("\n")}}this.placeholders.strings.push(a);return"@PLACEHOLDERSTRINGS"+
(this.placeholders.strings.length-1)+"END"};h.enumerateBlockComment=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="text"in arguments[0]?arguments[0].text:"":typeof a==="undefined"&&(a="");var d="";a.charAt(0)!=="/"&&(d=a.charAt(0),a=a.substring(1,a.length));this.placeholders.blockcomments.push(a);return d+"@PLACEHOLDERBLOCKCOMMENTS"+(this.placeholders.blockcomments.length-1)+"END"};h.enumerateLineComment=function(a){arguments.length===1&&typeof arguments[0]===
"object"&&arguments[0]._===null?a="text"in arguments[0]?arguments[0].text:"":typeof a==="undefined"&&(a="");var d="",e="";a.charAt(0)!=="/"&&(d=a.charAt(0),a=a.substring(1,a.length));a.charAt(a.length-1)==="\n"&&(e="\n",a=a.substring(0,a.length-1));this.placeholders.linecomments.push(a);return d+"@PLACEHOLDERLINECOMMENTS"+(this.placeholders.linecomments.length-1)+"END"+e};h.getPlaceholder=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="text"in arguments[0]?
arguments[0].text:"":typeof a==="undefined"&&(a="");var d=a.replace(/@PLACEHOLDER([^\d]+)\d+END/,"$1").toLowerCase(),e=Number(a.replace(/@PLACEHOLDER[^\d]+(\d+)END/,"$1"));return this.placeholders[d][e]};h.preserveKeywordSpacing=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="text"in arguments[0]?arguments[0].text:"":typeof a==="undefined"&&(a="");return a.charAt(1).match(/^\w/)===null?a.replace(/^ *([\(\)\{\}\=\:,\|\&\*\+\/\-\!\[\]\?<>\;]) */,"$1"):a.replace(/([\s\S])(\w+) *([\(\)\{\}\=\:,\|\&\*\+\/\-\!\[\]\?<>\;]) */,
"$1$2 $3")};h.restoreObjectLiteral=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="text"in arguments[0]?arguments[0].text:"":typeof a==="undefined"&&(a="");var d=0,e=a.indexOf("("),b;for(b=e;b<a.length;b++)if(a.charAt(b).match(/\(/)!==null?d++:a.charAt(b).match(/\)/)!==null&&d--,d===0)break;return"{"+a.substring(e+1,b)+"}"+a.substring(b+1,a.length)};h.withHandler=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="text"in
arguments[0]?arguments[0].text:"":typeof a==="undefined"&&(a="");var d=0,e=0,b=a.indexOf("with"),f,c="",l=[],k="",g;for(f=b;f<a.length;f++)if(a.charAt(f).match(/[\(\{]/)!==null)d++,d===1&&a.charAt(f)==="{"&&(b=f);else if(a.charAt(f).match(/[\}\)]/)!==null&&(d--,d===0))if(a.charAt(f)===")")c=a.substring(a.substring(b,f).indexOf("(")+(b+1),f);else if(a.charAt(f)==="}"){e=f;break}if(e===0)return a;d=a.substring(b+1,e);if(c.match(/as [a-zA-Z$_][\w$]*$/)!==null){b=0;g=-1;for(f=0;f<c.length;f++)c.charAt(f).match(/[\{\(\[]/)!==
null&&b++,c.charAt(f).match(/[\}\)\]]/)!==null&&b--,b===0&&c.charAt(f)===","&&(l.push(c.substring(g+1,f)),g=f,f++),f===c.length-1&&l.push(c.substring(g+1,f+1));c="";for(f=0;f<l.length;f++)k+=l[f].replace(/[\s\S]*as ([a-zA-Z$_][\w$]*)$/,"$1")+",",c+=l[f].replace(/([\s\S]*[^\s]+)\s*as [a-zA-Z$_][\w$]*$/,"$1")+",";d="(function ("+k.substring(0,k.length-1)+"){"+d+"})("+c.substring(0,c.length-1)+")";a=a.substring(0,a.indexOf("with"))+d+a.substring(e+1,a.length)}return a};h.strikeImmutableElements=function(a){arguments.length===
1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="compiler"in arguments[0]?arguments[0].compiler:this:typeof a==="undefined"&&(a=this);this.text=this.text.replace(/isn't/g,"@PLACEHOLDERISNTEND");this.text=this.text.replace(/([^\\])\/\//g,"$1@PLACEHOLDERDOUBLEFORWARDSLASHEND");this.text=this.text.replace(/[^\/\w]\/[^\/\*\n]([^\n]*?[^\\\n])?\/[gimy]{0,4}/g,function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);
return a.enumerateRegex.call(a,d)});this.text=this.text.replace(/@PLACEHOLDER{1}DOUBLEFORWARDSLASHEND/g,"//");this.text=this.text.replace(/(["'])(\\\1|[^\1\n]|\\\n)*?\1/g,function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.enumerateString.call(a,d)});this.text=this.text.replace(/\/\*[\s\S]*?\*\//g,function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?
arguments[0].text:void 0);return a.enumerateBlockComment.call(a,d)});this.text=this.text.replace(/\/\/[^\n]*\n/g,function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.enumerateLineComment.call(a,d)});this.text=this.text.replace(/@PLACEHOLDER{1}ISNTEND/g,"isn't")};h.normaliseFormatting=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="compiler"in arguments[0]?arguments[0].compiler:
this:typeof a==="undefined"&&(a=this);this.text=this.text.replace(/\r\n/g,"\n");this.text=this.text.replace(/\t/g," ");this.text=this.text.replace(/ +/g," ");this.text=this.text.replace(/\n /g,"\n");this.text=this.text.replace(/([^\w\$])function([^\w\$])/g,"$1$2");this.text=this.text.replace(/^function((?: *\n* *)*)([^\w\$])/,"$1$2");this.text=this.text.replace(/([^\w\$])(if|for|while|catch|switch):/g,"$1$2");this.text=this.text.replace(/(([^\w\$](if|for|while|catch|return|switch|typeof|instanceof|in|throw|finally))| *) *([\(\)\{\}\=\:,\|\&\*\+\/\-\!\[\]\?<>\;]) */g,
function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.preserveKeywordSpacing.call(a,d)});this.text=this.text.replace(/[\,\;](\s*)((?:@PLACEHOLDER[A-Z]+COMMENTS+\d+END\s*)*)(\s*)(\})/g,"$1$2$3$4");this.text=this.text.replace(/\,(\s*)((?:@PLACEHOLDER[A-Z]+COMMENTS+\d+END\s*)*)(\s*)(\))/g,"$1$2$3$4");this.text=this.text.replace(/([:\?])((?: *\n* *)*)((?:@PLACEHOLDER[A-Z]+COMMENTS+\d+END\s*)*)((?: *\n* *)*)(\S)/g,
"$2$3$4$1$5")};h.convertEnglishOperators=function(){this.text=this.text.replace(/([^\w$.])isn'?t([^:)\w$])/g,"$1is not$2");this.text=this.text.replace(/([^\w$.])(?:is\s*)?not\s*like([^:)\w$])/g,"$1!=$2");this.text=this.text.replace(/([^\w$.])(?:is\s*)?like([^:)\w$])/g,"$1==$2");this.text=this.text.replace(/([^\w$.])(?:(?:is\s*not)|isn'?t)([^:)\w$])</g,"$1>=$2");this.text=this.text.replace(/([^\w$.])(?:(?:is\s*not)|isn'?t)([^:)\w$])>/g,"$1<=$2");this.text=this.text.replace(/([^\w$.])(?:(?:is\s*not)|isn'?t)([^:)\w$])/g,
"$1!==$2");this.text=this.text.replace(/([^\w$.])is(\s*[<>!=])/g,"$1$2");this.text=this.text.replace(/([^\w$.])is([^:)\w$])/g,"$1===$2");this.text=this.text.replace(/([^\w$.])not([^:)\w$])/g,"$1!$2");this.text=this.text.replace(/([^\w$.])and([^:)\w$])/g,"$1&&$2");this.text=this.text.replace(/([^\w$.])or([^:)\w$])/g,"$1||$2")};h.insertVar=function(){this.text=this.text.replace(/^(\s*)(\(?)\* *(\n*) */gm,"$1$2var $2");this.text=this.text.replace(/([\({;:])\* *(\n*) */g,"$1var $2")};h.detectNonEmptyObjectLiterals=
function(){var a=0,d=!1,e=this.text.lastIndexOf("}")+1,b=[],f,c,l=0;for(f=0;f<this.text.length;f++)this.text.charAt(f)==="{"&&b.push(f);for(f=c=b.shift();f<=e;f++)if(this.text.charAt(f).match(/[\({]/)!==null?a++:this.text.charAt(f).match(/[\)}]/)!==null&&a--,a===1&&this.text.charAt(f)===":"&&this.text.substring(c,f).match(/\?|case/i)===null&&(d=!0),f>c+250&&d===!1)a=0,f=c=b.shift()+l,f--;else if(a===0){if(d===!0&&this.text.charAt(f)==="}")this.text=this.text.substring(0,c)+"OBJECTLITERALSTART("+this.text.substring(c+
1,f)+")"+this.text.substring(f+1,this.text.length),l+=18,e+=18;d=!1;a=0;f=c=b.shift()+l;f--}};h.preserveEmptyObjectLiterals=function(){this.text=this.text.replace(/([\[\=\|\:\&\!\(,\}\(]\s*)\{\}/g,"$1OBJECTLITERALSTART()")};h.wrapLoopsAndConditionals=function(){var a=/[^\w\$](if|for|while|catch|switch|with)[^\w\$]/g,d=[],e,b,f,c,l;for(this.text.match(/^(if|for|while|catch|switch|with)[^\w\$]/)!==null&&d.push(this.text.replace(/^(if|for|while|catch|switch|with)[\s\S]*$/,"$1").length);a.exec(this.text)!==
null;)this.text.substring(0,a.lastIndex-1).match(/\} *while$/)===null&&d.push(a.lastIndex-1);d.reverse();for(a=0;a<d.length;a++){b=d[a];c=f=0;for(e=b;e<this.text.length;e++){l=this.text.charAt(e);l==="("&&(f===0&&c++,f++);l===")"&&f--;if(f<0)break;if(f===0&&l==="{"){expression=this.text.substring(b,e);if(expression.match(/^\s*\([\s\S]*\)\s*$/)===null||c>1)this.text=this.text.substring(0,b)+"("+expression.replace(/^\s*([\s\S]*?)\s*$/,"$1")+")"+this.text.substring(e,this.text.length);break}}}this.text=
this.text.replace(/([^\w\$])(if|for|while|catch|switch|with)\s*/g,"$1$2")};h.shorthandLoops=function(){for(var a;this.text.match(/([^\w\d$])(\d+)[ \t]*\{/)!==null;)a="_"+Math.ceil(Math.random()*1E3),this.text=this.text.replace(/([^\w\d$])(\d+)[ \t]*\{/,"$1for(var "+a+"=0;"+a+"<$2;"+a+"++){");for(;this.text.match(/([^\w\d$])for\s*\(\s*(\d+)\s*\)[ \t]*\{/)!==null;)a="_"+Math.ceil(Math.random()*1E3),this.text=this.text.replace(/([^\w\d$])for\s*\(\s*(\d+)\s*\)[ \t]*\{/,"$1for(var "+a+"=0;"+a+"<$2;"+a+
"++){");this.text=this.text.replace(/([^\w\d$])(\d+)\s*as\s+([a-zA-Z_\$][\w$]*)[ \t]*\{/,"$1for(var $3=0;$3<$2;$3++){");this.text=this.text.replace(/([^\w\d$])for\s*\(\s*(\d+)\s*as\s+([a-zA-Z_$][\w$]*)\s*\)[ \t]*\{/,"$1for(var $3=0;$3<$2;$3++){")};h.convertMessagingSyntax=function(){function a(a,b,c){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?(c="endIndex"in arguments[0]?arguments[0].endIndex:0,b="startIndex"in arguments[0]?arguments[0].startIndex:0,a="block"in arguments[0]?
arguments[0].block:""):(typeof c==="undefined"&&(c=0),typeof b==="undefined"&&(b=0),typeof a==="undefined"&&(a=""));if(a.match(/^\[\s*(?:\*|(?:var\s+))\s*[\w$\/]+\s*=?\s*new\s+\S+?\s*(?:\([\s\S]*\))?\s*\]$/)!==null)return 0;if(a.match(/^\[\s*(?:delete|promote|demote)\s+[\w$\/]+\s*\]$/)!==null)return 1;if(a.match(/^\[\s*[\w$\/]+\s+[a-zA-Z_$][\w$]*(?:\s*,\s*[a-zA-Z_$][\w$]*)*\s*\]$/)!==null)return 2;if(a.match(/^\[\s*[\w$\/]+\s+[a-zA-Z_$][\w$]*\s*\((?:[\s\S]*?)?\)\s*\]$/)!==null)return 3;if(a.match(/^\[\s*[\w$\/]+\s*\{[\s\S]*?\}\]$/)!==
null)return 4;return-1}var d=[],e,b,f,c,l=!1;for(e=/\[/g;e.exec(this.text)!==null;)d.push(e.lastIndex-1);var k=[];for(e=0;e<d.length;e++){c=0;var g=!0;for(b=d[e];b<this.text.length;b++)if(this.text.charAt(b).match(/[\{\(\[]/)!==null&&c++,this.text.charAt(b).match(/[\}\)\]]/)!==null&&c--,c===0){if(this.text.charAt(b)==="]"){var h=this.text.substring(d[e],b+1);c=a.call(this,h,d[e],b);f=this.text.substring(b+1,this.text.length).match(/^\s*\{/)!==null?!0:!1;c>=0&&k.push({type:c,hasHandler:f,startIndex:d[e],
endIndex:b,raw:h,simple:g})}break}else if(c>1&&this.text.charAt(b)==="["){h=0;for(f=b;f<this.text.length;f++)if(this.text.charAt(f).match(/[\{\(\[]/)!==null&&h++,this.text.charAt(f).match(/[\}\)\]]/)!==null&&h--,h===0&&this.text.charAt(f)==="]"){var m=this.text.substring(b,f+1);if(a.call(this,m,b,f)!==-1){g=!1;break}}}}k.reverse();for(e=0;e<k.length;e++)if(h=k[e],h.simple===!0){contents=h.raw.substring(1,h.raw.length-1).replace(/^\s*([\s\S]+?)\s*$/,"$1");if(h.type===2&&!h.hasHandler)h.type=3;var o;
f=[];var p,d="type:";switch(h.type){case 0:b=contents.replace(/^(?:\*|(?:var\s+))\s*([\w$\/]+)\s*=?\s*new\s+(\S+?)\s*(?:\(([\s\S]*)\))?$/,"$1::$2::$3").split("::");o=b[0];g=b.length>1?b[1]:"";m=b.length>2?b[2]:"";c=0;lastComma=-1;for(b=0;b<m.length;b++)m.charAt(b).match(/[\{\(\[]/)!==null&&c++,m.charAt(b).match(/[\}\)\]]/)!==null&&c--,c===0&&m.charAt(b)===","&&(f.push(m.substring(lastComma+1,b)),lastComma=b,b++),b===m.length-1&&f.push(m.substring(lastComma+1,b+1));d+=this.enumerateString('"create"')+
",constructor:"+this.enumerateString('"'+g+'"');d+=f.length>0&&f[0].match(/^[a-zA-Z_$][\w$]*:/)!==null?g==="Object"?",args:[PRISMEXPRESSIONSTART(new Object("+f.join(",")+"))]":",args:[PRISMEXPRESSIONSTART("+f.join(",")+")]":",args:[PRISMEXPRESSIONSTART("+(f.length>0?f.join("),PRISMEXPRESSIONSTART("):"")+")]";break;case 1:b=contents.replace(/^(delete|promote|demote)\s+([\w$\/]*)$/,"$1::$2").split("::");mode=b[0];o=b.length>1?b[1]:"";d+=this.enumerateString('"'+mode+'"');break;case 2:b=contents.replace(/^([\w$\/]+)\s+([a-zA-Z_$][\w$]*(?:\s*,\s*[a-zA-Z_$][\w$]*)*)$/,
"$1::$2").split("::");o=b[0];p=b.length>1?b[1].replace(/\s*/g,"").split(","):[];d+=this.enumerateString('"query"');d+=",properties:["+this.enumerateString('"'+p.join('","')+'"')+"]";break;case 3:b=contents.replace(/^([\w$\/]+)\s+([a-zA-Z_$][\w$]*)\s*(?:\(([\s\S]+?)?\))?$/,"$1::$2::$3").split("::");o=b[0];if(o.indexOf(",")!==-1){h.type=2;b=contents.replace(/^([\w$\/]+)\s+([a-zA-Z_$][\w$]*(?:\s*,\s*[a-zA-Z_$][\w$]*)*)$/,"$1::$2").split("::");o=b[0];p=b.length>1?b[1].replace(/\s*/g,"").split(","):[];
d+=this.enumerateString('"query"');d+=",properties:["+this.enumerateString('"'+p.join('","')+'"')+"]";break}g=b.length>1?b[1]:"";m=b.length>2?b[2]:"";c=0;lastComma=-1;for(b=0;b<m.length;b++)m.charAt(b).match(/[\{\(\[]/)!==null&&c++,m.charAt(b).match(/[\}\)\]]/)!==null&&c--,c===0&&m.charAt(b)===","&&(f.push(m.substring(lastComma+1,b)),lastComma=b,b++),b===m.length-1&&f.push(m.substring(lastComma+1,b+1));d+=this.enumerateString('"invoke"')+",method:"+this.enumerateString('"'+g+'"');d+=",args:[PRISMEXPRESSIONSTART("+
(f.length>0?f.join("),PRISMEXPRESSIONSTART("):"")+")]";break;case 4:b=contents.replace(/^([\w$\/]+)\s*(\{[\s\S]*?\})$/,"$1::$2").split("::"),o=b[0],src="PRISMEVALBLOCKSTART"+b[1],d+=this.enumerateString('"eval"')+",src:"+src}if(h.hasHandler===!0){d+=",callback:MESSAGEHANDLERSTART";b="";b=h.type===2?p.join(","):"result";outerDepth=0;for(f=h.endIndex+1;f<this.text.length;f++)if(this.text.charAt(f).match(/[\{\(\[]/)!==null&&outerDepth++,this.text.charAt(f).match(/[\}\)\]]/)!==null&&outerDepth--,outerDepth===
0&&this.text.charAt(f)==="}"){endIndex=f;break}c=this.text.substring(h.endIndex+1,endIndex+1);d+="("+b+")";b="prism.send("+this.enumerateString('"'+o+'"')+",new Object("+d+c+"))";this.text=this.text.substring(0,h.startIndex)+b+this.text.substring(endIndex+1,this.text.length)}else b="prism.send("+this.enumerateString('"'+o+'"')+",new Object("+d+"))",this.text=this.text.substring(0,h.startIndex)+b+this.text.substring(h.endIndex+1,this.text.length)}else l=!0;l===!0&&this.convertMessagingSyntax()};h.reconstituteFunctions=
function(){var a=[],d=[],e,b,f,c,h,k,g,n;for(e=g=0;e<this.text.length;e++)this.text.charAt(e)==="{"&&a.push(e);for(e=a.length-1;e>=0;e--){c="";h=!1;for(b=a[e]-1;b>=0;b--)if(this.text.charAt(b).match(/[\n]/)!==null){c=this.text.substring(b+1,a[e]);break}else b===0&&(c=this.text.substring(b,a[e]));c=c.replace(/^\s*/,"");k=c.charAt(c.length-1);if(c==="")d.push({raw:c,flags:[0,-1,1,"anonymous inline, no args"],start:a[e],end:a[e]-1});else if(c.match(/[^\w\$](else|finally|try|do|PRISMEVALBLOCKSTART)$/)!==
null||c.match(/^(else|finally|try|do|PRISMEVALBLOCKSTART)$/)!==null)continue;else if(k===")"){k=0;g="";b=!1;for(f=c.length-1;f>=0;f--)if(c.charAt(f)===")"&&k++,c.charAt(f)==="("&&k--,k===0){g=c.substr(f,c.length);break}if(g==="")continue;k=c.substring(0,f).replace(/[\s\S]*?\s*(\.?)\s*((?:[a-zA-Z_\$][\w\$]*)|\])?$/,"$1$2");k.charAt(0)==="."&&(h=!0,k=k.substring(1,k.length));k.charAt(k.length-1)==="]"&&(h=!0,k="]");c.length===(k+g).length&&(b=!0);c=k+g;if(c.match(/^(if|for|while|catch|switch|with)[^\w\$]/)!==
null||c.match(/^\d/)!==null)continue;g==="()"?k===""?b===!1?d.push({raw:c,flags:[0,0,0,"anonymous, empty args"],start:a[e]-c.length,end:a[e]-1}):d.push({raw:c,flags:[0,0,1,"anonymous, empty args (inline)"],start:a[e]-c.length,end:a[e]-1}):d.push({raw:c,flags:[1,0,0,"id, empty args"],start:a[e]-c.length,end:a[e]-1,dotted:h}):k===""?g.indexOf("=")!==-1?b===!1?d.push({raw:c,flags:[0,2,0,"anonymous, args with default"],start:a[e]-c.length,end:a[e]-1,args:g.substring(1,g.length-1)}):d.push({raw:c,flags:[0,
2,1,"anonymous, args with default (inline)"],start:a[e]-c.length,end:a[e]-1,args:g.substring(1,g.length-1)}):b===!1?d.push({raw:c,flags:[0,1,0,"anonymous, args"],start:a[e]-c.length,end:a[e]-1,args:g.substring(1,g.length-1)}):d.push({raw:c,flags:[0,1,1,"anonymous, args (inline)"],start:a[e]-c.length,end:a[e]-1,args:g.substring(1,g.length-1)}):g.indexOf("=")!==-1?d.push({raw:c,flags:[1,2,0,"id, args with default"],start:a[e]-c.length,end:a[e]-1,args:g.substring(1,g.length-1),dotted:h}):d.push({raw:c,
flags:[1,1,0,"id, args"],start:a[e]-c.length,end:a[e]-1,args:g.substring(1,g.length-1),dotted:h})}else k==="?"||k===":"||k==="="||k===","?(c="",d.push({raw:c,flags:[0,-1,0,"anonymous assignment or ternary, no args"],start:a[e],end:a[e]-1})):k===";"?(c="",d.push({raw:c,flags:[0,-1,1,"anonymous assignment, no args (inline)"],start:a[e],end:a[e]-1})):c.match(/\s*\.?\s*[a-zA-Z_\$][\w\$]*$/)!==null?(c=c.replace(/[\s\S]*?(\.?)\s*([a-zA-Z_\$][\w\$]*)$/,"$1$2"),c.charAt(0)==="."&&(h=!0,c=c.substring(1,c.length)),
d.push({raw:c,flags:[1,-1,0,"id, no args"],start:a[e]-c.length,end:a[e]-1,dotted:h})):k==="]"?(c="",h=!0,d.push({raw:c,flags:[1,-1,0,"array access, no args"],start:a[e],end:a[e]-1,dotted:h})):c.match(/^.*[\?\:\=]\s*[a-zA-Z_\$][\w\$]*$/)!==null?(c=c.replace(/^.*[\?\:\=]\s*([a-zA-Z_\$][\w\$]*)$/,"$1"),d.push({raw:c,flags:[1,-1,0,"id assignment or ternary, no args"],start:a[e]-c.length,end:a[e]-1})):k==="("?d.push({raw:"",flags:[0,-1,0,"anonymous wrapped in parens, no args"],start:a[e],end:a[e]-1}):
d.push({raw:c,flags:[-1,"unclassified"],start:b,end:a[e]-1});d[d.length-1].argBlock=""}for(e=0;e<d.length;e++)if(d[e].raw.substr(0,19)==="MESSAGEHANDLERSTART"){c=d[e].args||[];k=h=0;g=[];for(b=0;b<c.length;b++)c.charAt(b).match(/[\(\{\[]/)!==null?k++:c.charAt(b).match(/[\)\}\]]/)!==null&&k--,c.charAt(b)===","&&k===0?(g.push(c.substring(h,b)),h=b+1):b===c.length-1&&g.push(c.substring(h,b+1));a="";for(b=g.length-1;b>=0;b--)k=g[b].split("="),k.length>1&&(a+="if(typeof "+k[0]+'!=="undefined"){'+k[0]+
"="+k[1]+"}");d[e].argBlock=a;d[e].raw=d[e].raw.substring(19,d[e].raw.length);c="";for(b=0;b<g.length;b++)c+=g[b].match(/\=/)!==null?g[b].split("=")[0]+",":g[b]+",";d[e].args=c.substring(0,c.lastIndexOf(","))}else{if(this.text.charAt(d[e].end+1)!=="}")d[e].hasBody=!0;if(d[e].flags[1]>0)if(d[e].hasBody){a='if(arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null){';if(d[e].flags[1]===2){c=d[e].args;k=h=0;g=[];for(b=0;b<c.length;b++)c.charAt(b).match(/[\(\{\[]/)!==null?k++:c.charAt(b).match(/[\)\}\]]/)!==
null&&k--,c.charAt(b)===","&&k===0?(g.push(c.substring(h,b)),h=b+1):b===c.length-1&&g.push(c.substring(h,b+1));c="";for(b=0;b<g.length;b++)g[b].match(/\=/)!==null?(k=g[b].split("="),c+=k[0]+","):c+=g[b]+",";d[e].args=c.substring(0,c.lastIndexOf(","));for(b=g.length-1;b>=0;b--)g[b].match(/\=/)!==null?(k=g[b].split("="),a+=b>0?k[0]+'="'+k[0]+'"in arguments[0]?arguments[0].'+k[0]+":"+k[1]+";":k[0]+'="'+k[0]+'"in arguments[0]?arguments[0].'+k[0]+":"+k[1]):a+=b>0?'if("'+g[b]+'"in arguments[0]){'+g[b]+
"=arguments[0]."+g[b]+"}":g[b]+'="'+g[b]+'"in arguments[0]?arguments[0].'+g[b]+":undefined";a+="}else{";n="";for(b=g.length-1;b>=0;b--)g[b].match(/\=/)!==null&&(k=g[b].split("="),a+="if(typeof "+k[0]+'==="undefined"){'+k[0]+"="+k[1]+"}",n+="if(typeof "+k[0]+'==="undefined"){'+k[0]+"="+k[1]+"}")}else{g=d[e].args.split(",");for(b=g.length-1;b>=0;b--)a+=b>0?'if("'+g[b]+'"in arguments[0]){'+g[b]+"=arguments[0]."+g[b]+"}":g[b]+'="'+g[b]+'"in arguments[0]?arguments[0].'+g[b]+":undefined"}a+="}";d[e].argBlock=
a;d[e].altargBlock=n}else if(d[e].flags[1]===2){g=d[e].args.split(",");c="";for(b=0;b<g.length;b++)c+=g[b].match(/\=/)!==null?g[b].split("=")[0]+",":g[b]+",";d[e].args=c.substring(0,c.lastIndexOf(","))}if(d[e].flags[1]===0)d[e].args=""}for(e=g=0;e<d.length;e++)if(c=d[e],b=!1,c.flags[2]===1&&c.flags[0]===0?(prefixStr="INLINEFUNCTIONSTARTfunction ",g++,b=!0):prefixStr="function ",c.flags[0]!==-1)c.flags[0]===0?prefixStr+=c.flags[1]!==-1?"("+c.args+")":"()":c.flags[0]===1&&(c.flags[1]!==-1?c.dotted?
prefixStr=c.raw.charAt(0)==="]"?c.raw.substring(0,c.raw.indexOf("("))+"=function ("+c.args+")":c.raw.substring(0,c.raw.indexOf("("))+"=function "+c.raw.substring(0,c.raw.indexOf("("))+"("+c.args+")":prefixStr+=c.raw.substring(0,c.raw.indexOf("("))+"("+c.args+")":c.dotted?prefixStr=c.raw.charAt(0)==="]"?c.raw+"=function ()":c.raw+"=function "+c.raw+"()":prefixStr+=c.raw+"()"),prefixStr+="{"+(b&&c.altargBlock?c.altargBlock:c.argBlock),this.text=this.text.substring(0,c.start)+prefixStr+this.text.substring(c.end+
2,this.text.length);for(e=0;e<g;e++){tagstart=this.text.indexOf("INLINEFUNCTIONSTART");tagend=tagstart+19;this.text=this.text.substr(0,tagstart)+"("+this.text.substring(tagend,this.text.length);k=0;d="(";n=")";for(b=tagstart+1;b<this.text.length;b++)if(this.text.charAt(b)===d&&k++,this.text.charAt(b)===n&&k--,k===0&&this.text.charAt(b)===")")d="{",n="}";else if(k===0&&this.text.charAt(b)==="}"){this.text=this.text.substr(0,b+1)+")()"+this.text.substring(b+1,this.text.length);break}}};h.reconstituteObjectLiterals=
function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="compiler"in arguments[0]?arguments[0].compiler:this:typeof a==="undefined"&&(a=this);for(var d="";this.text!==d;)d=this.text,this.text=this.text.replace(/OBJECTLITERALSTART\([\s\S]*\)/,function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.restoreObjectLiteral.call(a,d)})};h.convertNamedArguments=function(){this.text=
this.text.replace(/new[ \t]*Object/,"new Object");for(var a=0,d=!1,e=this.text.lastIndexOf(")")+1,b=[],a=/new Object\(/g,f,c;a.exec(this.text)!==null;)b.push(a.lastIndex-1);for(c=offset=0;c<b.length;c++){a=0;d=!1;for(f=start=b.pop();f<=e;f++)if(this.text.charAt(f).match(/[\(\{]/)!==null?a++:this.text.charAt(f).match(/[\)\}]/)!==null&&a--,a===1&&this.text.charAt(f)===":"&&this.text.substring(start,f).match(/\?/)===null&&(d=!0),a===0){if(d===!0&&this.text.charAt(f)===")")this.text=this.text.substring(0,
start-10)+"{"+this.text.substring(start+1,f)+"}"+this.text.substring(f+1,this.text.length);d=!1;f=start=b.pop();f--}e=f}e=this.text.lastIndexOf(")")+1;b=[];for(f=0;f<this.text.length;f++)this.text.substr(f,2).match(/^\([^\{\)\[]/)!==null&&b.push(f);for(c=offset=0;c<b.length;c++){a=0;d=!1;for(f=start=b.pop();f<=e;f++)if(this.text.charAt(f).match(/[\(\{]/)!==null?a++:this.text.charAt(f).match(/[\)\}]/)!==null&&a--,a===1&&this.text.charAt(f)===":"&&this.text.substring(start,f).match(/\?/)===null&&(d=
!0),a===0){if(d===!0&&this.text.charAt(f)===")")this.text=this.text.substring(0,start)+"({_:null,"+this.text.substring(start+1,f)+"})"+this.text.substring(f+1,this.text.length);d=!1;f=start=b.pop();f--}e=f}};h.rewriteWith=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="compiler"in arguments[0]?arguments[0].compiler:this:typeof a==="undefined"&&(a=this);this.text=this.text.replace(/^with[^\w\$][\s\S]*}/,function(d){arguments.length===1&&typeof arguments[0]===
"object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.withHandler.call(a,d)});for(var d;this.text.match(/[^\w\$]with[^\w\$][\s\S]*}/)!==null&&this.text!==d;)d=this.text,this.text=this.text.replace(/[^\w\$]with[^\w\$][\s\S]*}/g,function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.withHandler.call(a,d)})};h.separateAdjacentTerminators=function(){this.text=this.text.replace(/([\)}\w\$])(\s*?\n((?:@PLACEHOLDER[A-Z]+COMMENTS+\d+END\s*)*)\s*?\()/g,
"$1;$2")};h.restoreImmutables=function(a){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?a="compiler"in arguments[0]?arguments[0].compiler:this:typeof a==="undefined"&&(a=this);this.text=this.text.replace(/@PLACEHOLDERBLOCKCOMMENTS\d+END/g,function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.getPlaceholder.call(a,d)});this.text=this.text.replace(/@PLACEHOLDERLINECOMMENTS\d+END/g,
function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.getPlaceholder.call(a,d)});this.text=this.text.replace(/@PLACEHOLDERBLOCKCOMMENTS\d+END/g,function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.getPlaceholder.call(a,d)});this.text=this.text.replace(/@PLACEHOLDERSTRINGS\d+END/g,function(d){arguments.length===
1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.getPlaceholder.call(a,d)});this.text=this.text.replace(/@PLACEHOLDERREGEX\d+END/g,function(d){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null&&(d="text"in arguments[0]?arguments[0].text:void 0);return a.getPlaceholder.call(a,d)});this.text=this.text.replace(/@PLACEHOLDER{1}ISNTEND/g,"isn't")};h.finalise=function(){function a(a){arguments.length===1&&typeof arguments[0]===
"object"&&arguments[0]._===null?a="text"in arguments[0]?arguments[0].text:"":typeof a==="undefined"&&(a="");if(a.match(/\n/)!==null){var d=a.split("\n"),c=Infinity,e,h=!0;if(d[0].match(/^ +/)===null)for(var g=1;g<d.length;g++){var n=d[g].replace(/^( +|\t+)[^\1][\s\S]*$/,"$1");if(n!==d[g]){if(n.charAt(0)!==e&&g>1){h=!1;break}c=Math.min(n.length,c);e=n.charAt(0)}else c=0}if(c>0&&c<Infinity&&h===!0){for(g=1;g<d.length;g++)d[g]=d[g].substring(c,d[g].length);a=d.join("\n")}}a=a.replace(/([^\\])""/g,'$1\\"\\"');
a=a.replace(/([^\\])"/g,'$1\\"');a=a.replace(/^"/g,'\\"');a=a.replace(/([^\\])(\n)/g,"$1\\n\\$2");return a=a.replace(/^(\n)/gm,"\\n\\$1")}this.text=this.text.replace(/([\)}])(\s*?\n\s*?\()/g,"$1;$2");for(var d=/PRISMEXPRESSIONSTART\(/g,e=[];d.exec(this.text)!==null;)e.push(d.lastIndex-1);e.reverse();for(i=0;i<e.length;i++){depth=0;for(j=e[i];j<this.text.length;j++)if(this.text.charAt(j)==="("&&depth++,this.text.charAt(j)===")"&&depth--,depth===0){if(this.text.charAt(j)===")")this.text=this.text.substring(0,
e[i]-20)+this.text.substring(e[i]+1,j)+this.text.substring(j+1,this.text.length);break}}d=/PRISMEVALBLOCKSTART\{/g;for(e=[];d.exec(this.text)!==null;)e.push(d.lastIndex-1);e.reverse();for(i=0;i<e.length;i++){depth=0;for(j=e[i];j<this.text.length;j++)if(this.text.charAt(j)==="{"&&depth++,this.text.charAt(j)==="}"&&depth--,depth===0){if(this.text.charAt(j)==="}")this.text=this.text.substring(0,e[i]-19)+'"'+a(this.text.substring(e[i]+1,j))+'"'+this.text.substring(j+1,this.text.length);break}}}})(JS11.compiler.prototype);
if(typeof window==="undefined"&&typeof global==="undefined"){var compiler=new JS11.compiler;this.onmessage=function(h){arguments.length===1&&typeof arguments[0]==="object"&&arguments[0]._===null?h="event"in arguments[0]?arguments[0].event:{data:""}:typeof h==="undefined"&&(h={data:""});postMessage({type:"JS11",src:compiler.toJS(h.data)})}};